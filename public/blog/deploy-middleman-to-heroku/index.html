<!doctype html>
<html class="no-js" lang="en-US" prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb#">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        
            <title> Deploy Middleman to Heroku - Khoa Pham </title>
<meta name="keywords" content="Khoa Pham, web developer, frontend developer, UX, UI, web developer Portland " >
<meta name="viewport" content="width=device-width initial-scale=1.0" />
<meta property="description" content="Heroku is a great cloud service, it uses git for version control and deployment which is very handy for me to just update my blog in one command.
Here are some simple step that you can set it up.
" >
<link rel="canonical" href="http://khoapham.me" />
<link rel="author" href="https://plus.google.com/103713398374675106375/"/>


<meta property="og:title" content="Deploy Middleman to Heroku" >
<meta property="og:site_name" content="Khoa Pham">
<meta property="og:url" content="http://khoapham.me" >
<meta property="og:description" content="Heroku is a great cloud service, it uses git for version control and deployment which is very handy for me to just update my blog in one command.
Here are some simple step that you can set it up.
" >
<meta property="og:type" content="website" >
<meta property="og:locale" content="en_US" >

<meta property="twitter:card" content="summary" >
<meta property="twitter:title" content="Deploy Middleman to Heroku - Khoa Pham" >
<meta property="twitter:description" content="Heroku is a great cloud service, it uses git for version control and deployment which is very handy for me to just update my blog in one command.
Here are some simple step that you can set it up.
" >
<meta property="twitter:creator" content="@pmkhoa" >
<meta property="twitter:url" content="http://khoapham.me" >

        

        
        <link rel="shortcut icon" href="http://khoapham.me/img/favicon.ico">

        
        <link rel="alternate" type="application/rss+xml" title="RSS" href="http://khoapham.me/index.xml">

        <link href='http://fonts.googleapis.com/css?family=Source+Code+Pro' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="http://khoapham.me/css/all.css">
        <link rel="stylesheet" href="http://khoapham.me/css/custom.css">
    </head>
    <body lang="en">
        <nav class="header" role="banner">
            <div class="inner-header wrap clearfix">
                <a id="logo" href="http://khoapham.me/">KHOA&nbsp;&nbsp;PHAM</a>
                <ul class="header-nav">
                    <li class="nav-item"><a href="http://khoapham.me/blog" title="Blog">Blog</a></li>
                    <li class="nav-item"><a href="http://khoapham.me" title="About">About</a></li>
                </ul>
            </div>
        </nav>

<div class="Article-wrapper">
    <div class="Article-container">
        <div class="Article-content wrap clearfix">
            <h1 class="Article-title">Deploy Middleman to Heroku</h1>
            <time datetime="2014-10-14 00:00:00 &#43;0000 UTC"><em>October 14, 2014</em></time>
            <p>Heroku is a great cloud service, it uses git for version control and deployment which is very handy for me to just update my blog in one command.
Here are some simple step that you can set it up.</p>

<p>In your Gemfile, add puma and rake:</p>

<pre><code>gem 'puma',      '~&gt; 2.7'
gem 'rake',      '~&gt; 10.1'
</code></pre>

<p>Create a Procfile, and add this code</p>

<pre><code>web: bundle exec puma -p $PORT
</code></pre>

<p>Since we&rsquo;re going to tell Heroku to use our build folder under our Middlemanapp, we will use the rake task to compile our build assets. Under your root app, create: Rakefile</p>

<pre><code>namespace :assets do
  task :precompile do
    sh 'middleman build'
  end
end
</code></pre>

<p>Finally we need to setup a Rack server to tell Heroku to load our build folder, and its assets</p>

<pre><code>module Rack
  class TryStatic
    def initialize(app, options)
      @app = app
      @try = ['', *options.delete(:try)]
      @static = ::Rack::Static.new(lambda { [404, {}, []] }, options)
    end
    def call(env)
      orig_path = env['PATH_INFO']
      found = nil
      @try.each do |path|
        resp = @static.call(env.merge!({'PATH_INFO' =&gt; orig_path + path}))
        break if 404 != resp[0] &amp;&amp; found = resp
      end
      found or @app.call(env.merge!('PATH_INFO' =&gt; orig_path))
    end
  end
end
use Rack::Deflater
use Rack::TryStatic, :root =&gt; &quot;build&quot;, :urls =&gt; %w[/], :try =&gt; ['.html', 'index.html', '/index.html']
# Run your own Rack app here or use this one to serve 404 messages:
run lambda{ |env|
  not_found_page = File.expand_path(&quot;../build/404.html&quot;, __FILE__)
  if File.exist?(not_found_page)
    [ 404, { 'Content-Type'  =&gt; 'text/html'}, [File.read(not_found_page)] ]
  else
    [ 404, { 'Content-Type'  =&gt; 'text/html' }, ['404 - page not found'] ]
  end
}
</code></pre>

<p>Now your site is ready to deploy to Heroku. Just create a Heroku app and add Heroku git remote link, and enjoy!</p>

<p>P.S. Don&rsquo;t forget to add the build directory to your .gitignore</p>

        </div>
        
        
        <div class="Article-related">
            <div class="Article-related-content wrap clearfix">
                <div class="Article-related-title">
                    <h3 class="uppercase"><span class="icon-shuffle"></span>More Articles</h3>
                </div>
                
                
                
                    
                    
                    
                
                    
                    
                    
                        <a href="http://khoapham.me/blog/deploy-ember-app-on-github-pages" class="link-to-article">
    <div class="Article-summary">
        <h3>Deploy Ember App on Github Pages</h3>
    </div>
</a>

                    
                
                    
                    
                    
                
                    
                    
                    
                
                    
                    
                    
                
                    
                    
                    
                
                    
                    
                    
                
                    
                    
                    
                
                    
                    
                    
                
                    
                    
                    
                
                    
                    
                    
                        <a href="http://khoapham.me/blog/set-up-nginx-with-centos" class="link-to-article">
    <div class="Article-summary">
        <h3>Set up Nginx with Centos</h3>
    </div>
</a>

                    
                
                    
                    
                    
                
                    
                    
                    
                
                    
                    
                    
                
                    
                    
                    
                        <a href="http://khoapham.me/blog/tower-of-hanoi" class="link-to-article">
    <div class="Article-summary">
        <h3>Tower of Hanoi</h3>
    </div>
</a>

                    
                
                    
                    
                    
                
                    
                    
                    
                
                    
                    
                    
                
                    
                    
                    
                
                    
                    
                    
                        <a href="http://khoapham.me/blog/completely-setup-resque-and-resque-scheduler" class="link-to-article">
    <div class="Article-summary">
        <h3>Completely setup Resque &#43; Resque Schedule and Resque Mailer</h3>
    </div>
</a>

                    
                
                    
                    
                    
                
                    
                    
                    
                
                    
                    
                    
                
                    
                    
                    
                
                    
                    
                    
                        <a href="http://khoapham.me/blog/setting-up-amazon-web-services" class="link-to-article">
    <div class="Article-summary">
        <h3>Setting up Amazon Web Services</h3>
    </div>
</a>

                    
                
                    
                    
                    
                
                    
                    
                    
                
            </div>
        </div>
        
    </div>
</div>
    <footer>
    <p class="footer-copyright">Carefully crafted by <a href="http://khoapham.me/about">Khoa Pham</a></p>
    </footer>

        <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-41349606-1', 'auto');
      ga('send', 'pageview');
    </script>

    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.9.1/highlight.min.js"></script>
    <script type="text/javascript">
        hljs.initHighlightingOnLoad(); 
    </script>
  </body>
</html>

